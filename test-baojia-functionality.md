# 线索报价功能测试指南

## 🎯 测试目标
验证线索报价功能的完整性，包括前端界面和后端API的集成。

## 📋 测试清单

### 1. 基础功能测试

#### ✅ 后端API测试
- [x] 产品数据获取API (`/api/v1/lead-quotes/product-data`)
- [x] 报价CRUD API端点存在
- [x] 权限控制正常工作
- [x] 数据模型完整

#### 🔄 前端组件测试
- [ ] 报价表单组件 (`XiansuoBaojiaForm.vue`)
- [ ] 产品选择器组件 (`ProductSelector.vue`)
- [ ] 报价列表组件 (`XiansuoBaojiaList.vue`)
- [ ] 报价详情组件 (`XiansuoBaojiaDetail.vue`)

### 2. 集成功能测试

#### 🔄 线索列表集成
- [ ] 动态报价按钮显示
  - [ ] 未报价时显示"报价"按钮
  - [ ] 已报价时显示"查看报价"按钮
- [ ] 报价按钮点击功能
- [ ] 更多菜单中的"编辑报价"选项

#### 🔄 线索详情集成
- [ ] 报价记录卡片显示
- [ ] 创建报价按钮功能
- [ ] 报价列表展示

### 3. 业务逻辑测试

#### 🔄 报价创建流程
1. [ ] 点击"报价"按钮
2. [ ] 打开报价表单弹窗
3. [ ] 选择服务项目
4. [ ] 设置数量和单价
5. [ ] 计算总金额
6. [ ] 提交报价
7. [ ] 验证15天有效期

#### 🔄 报价编辑流程
1. [ ] 点击"编辑报价"
2. [ ] 加载现有报价数据
3. [ ] 修改服务项目
4. [ ] 更新报价
5. [ ] 验证更新结果

#### 🔄 报价查看流程
1. [ ] 点击"查看报价"
2. [ ] 显示报价详情
3. [ ] 查看服务项目明细
4. [ ] 验证有效期显示

### 4. 边界条件测试

#### 🔄 权限控制
- [ ] 无权限用户无法创建报价
- [ ] 无权限用户无法编辑报价
- [ ] 无权限用户无法查看报价

#### 🔄 数据验证
- [ ] 必填字段验证
- [ ] 数量范围验证
- [ ] 价格格式验证
- [ ] 服务项目必选验证

#### 🔄 状态管理
- [ ] 过期报价处理
- [ ] 重复报价防护
- [ ] 报价状态更新

## 🚀 快速测试步骤

### 步骤1: 访问系统
1. 打开浏览器访问 http://localhost:5174
2. 使用管理员账号登录 (admin/admin123)

### 步骤2: 进入线索管理
1. 点击左侧菜单"线索管理"
2. 查看线索列表

### 步骤3: 测试报价功能
1. 找到一个线索，点击"报价"按钮
2. 在弹出的报价表单中：
   - 点击"添加服务"按钮
   - 选择服务项目
   - 设置数量和单价
   - 查看总金额计算
   - 点击"创建报价"

### 步骤4: 验证结果
1. 检查报价是否创建成功
2. 验证按钮是否变为"查看报价"
3. 点击"查看报价"查看详情

## 🐛 已知问题和解决方案

### 问题1: 产品数据结构不匹配
**现象**: ProductSelector组件期望的数据结构与API返回不匹配
**解决方案**: 需要调整数据映射逻辑

### 问题2: 权限检查
**现象**: 可能缺少报价相关权限
**解决方案**: 确认用户具有 `xiansuo:baojia_*` 权限

## 📊 测试结果

### 当前状态
- ✅ 后端API基础功能完成
- ✅ 前端组件基础结构完成
- 🔄 集成测试进行中
- ⏳ 端到端测试待进行

### 下一步计划
1. 修复产品数据结构映射
2. 完善权限控制
3. 优化用户体验
4. 添加错误处理
5. 性能优化

## 🎉 成功标准
- [ ] 用户可以成功创建报价
- [ ] 用户可以查看报价详情
- [ ] 用户可以编辑有效报价
- [ ] 系统正确处理过期报价
- [ ] 界面响应流畅，用户体验良好
