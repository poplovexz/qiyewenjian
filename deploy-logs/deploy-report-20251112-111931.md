# ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŠ¥å‘Š

**éƒ¨ç½²æ—¶é—´**: 2025-11-12 11:19:31  
**éƒ¨ç½²äººå‘˜**: AI Assistant  
**ç›®æ ‡æœåŠ¡å™¨**: 172.16.2.221 (saas@172.16.2.221)  
**éƒ¨ç½²æ–¹å¼**: å¿«é€Ÿéƒ¨ç½²è„šæœ¬ (quick-deploy.sh)

---

## ğŸ“‹ éƒ¨ç½²å†…å®¹

### 1. Gitæäº¤å¤‡ä»½
- **æäº¤å“ˆå¸Œ**: 6bb10d9
- **åˆ†æ”¯**: feature/contract-preview-improvements
- **æäº¤ä¿¡æ¯**: feat: é‡æ„é‡‡è´­/æŠ¥é”€ç”³è¯·æ¨¡å—ï¼Œå¯¹æ¥è´¢åŠ¡è®¾ç½®APIï¼Œæ·»åŠ è‡ªåŠ¨ç¼–ç ç”ŸæˆåŠŸèƒ½

### 2. ä¸»è¦åŠŸèƒ½æ›´æ–°

#### åç«¯æ›´æ–°
- âœ… æ–°å¢è´¢åŠ¡è®¾ç½®æ¨¡å—ï¼ˆæ”¶ä»˜æ¬¾æ¸ é“ã€æ”¶å…¥ç±»åˆ«ã€æŠ¥é”€ç±»åˆ«ã€æ”¯å‡ºç±»åˆ«ï¼‰
- âœ… å®ç°å®Œæ•´çš„CRUD APIæ¥å£
- âœ… æ·»åŠ è‡ªåŠ¨ç¼–ç ç”ŸæˆåŠŸèƒ½ï¼ˆSR/BX/ZCå‰ç¼€+æ—¥æœŸ+åºå·ï¼‰
- âœ… ä¿®å¤bianmaå­—æ®µå”¯ä¸€çº¦æŸå†²çªé—®é¢˜
- âœ… æ·»åŠ æ•°æ®åº“è¡¨åˆ›å»ºå’Œåˆå§‹åŒ–è„šæœ¬

**æ–°å¢æ–‡ä»¶**:
- `packages/backend/src/api/api_v1/endpoints/caiwu_guanli/caiwu_shezhi.py`
- `packages/backend/src/models/caiwu_guanli/caiwu_shezhi.py`
- `packages/backend/src/schemas/caiwu_guanli/caiwu_shezhi_schemas.py`
- `packages/backend/src/services/caiwu_guanli/caiwu_shezhi_service.py`
- `packages/backend/src/scripts/create_finance_settings_tables.py`
- `packages/backend/src/scripts/init_finance_settings_data.py`

**ä¿®æ”¹æ–‡ä»¶**:
- `packages/backend/src/api/api_v1/api.py` - æ³¨å†Œè´¢åŠ¡è®¾ç½®è·¯ç”±
- `packages/backend/src/models/__init__.py` - å¯¼å‡ºè´¢åŠ¡è®¾ç½®æ¨¡å‹
- `packages/backend/src/models/caiwu_guanli/__init__.py` - å¯¼å‡ºè´¢åŠ¡è®¾ç½®æ¨¡å‹
- `packages/backend/src/schemas/caiwu_guanli/__init__.py` - å¯¼å‡ºè´¢åŠ¡è®¾ç½®schemas

#### å‰ç«¯æ›´æ–°
- âœ… æ–°å¢è´¢åŠ¡è®¾ç½®ç®¡ç†é¡µé¢ï¼Œæ”¯å‡ºç±»åˆ«ä½¿ç”¨æ ‘çŠ¶å›¾å±•ç¤º
- âœ… é‡æ„é‡‡è´­ç”³è¯·è¡¨å•/åˆ—è¡¨/è¯¦æƒ…é¡µé¢ï¼Œç§»é™¤ç¡¬ç¼–ç ç±»å‹
- âœ… é‡æ„æŠ¥é”€ç”³è¯·è¡¨å•/åˆ—è¡¨/è¯¦æƒ…é¡µé¢ï¼Œç§»é™¤ç¡¬ç¼–ç ç±»å‹
- âœ… é‡‡è´­ç±»å‹ä»æ”¯å‡ºç±»åˆ«APIåŠ¨æ€è·å–
- âœ… æŠ¥é”€ç±»å‹ä»æŠ¥é”€ç±»åˆ«APIåŠ¨æ€è·å–
- âœ… åªæ˜¾ç¤ºå¯ç”¨çŠ¶æ€çš„ç±»åˆ«é€‰é¡¹
- âœ… æ·»åŠ loadingçŠ¶æ€å’Œé”™è¯¯å¤„ç†

**æ–°å¢æ–‡ä»¶**:
- `packages/frontend/src/api/modules/finance-settings.ts`
- `packages/frontend/src/views/settings/data/FinanceSettings.vue`
- `packages/frontend/src/views/settings/data/components/QudaoDialog.vue`
- `packages/frontend/src/views/settings/data/components/ShouruLeibieDialog.vue`
- `packages/frontend/src/views/settings/data/components/BaoxiaoLeibieDialog.vue`
- `packages/frontend/src/views/settings/data/components/ZhichuLeibieDialog.vue`

**ä¿®æ”¹æ–‡ä»¶**:
- `packages/frontend/src/router/index.ts` - æ·»åŠ è´¢åŠ¡è®¾ç½®è·¯ç”±
- `packages/frontend/src/views/settings/data/DataManagement.vue` - æ·»åŠ è´¢åŠ¡è®¾ç½®å…¥å£
- `packages/frontend/src/views/office/ProcurementForm.vue` - åŠ¨æ€åŠ è½½é‡‡è´­ç±»å‹
- `packages/frontend/src/views/office/ProcurementList.vue` - åŠ¨æ€ç­›é€‰é‡‡è´­ç±»å‹
- `packages/frontend/src/views/office/ProcurementDetail.vue` - æ˜¾ç¤ºç±»åˆ«åç§°
- `packages/frontend/src/views/office/ReimbursementForm.vue` - åŠ¨æ€åŠ è½½æŠ¥é”€ç±»å‹
- `packages/frontend/src/views/office/ReimbursementList.vue` - åŠ¨æ€ç­›é€‰æŠ¥é”€ç±»å‹
- `packages/frontend/src/views/office/ReimbursementDetail.vue` - æ˜¾ç¤ºç±»åˆ«åç§°

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤1: æœ¬åœ°æ„å»º
```bash
cd packages/frontend
npm run build:prod
```
- âœ… å‰ç«¯æ„å»ºæˆåŠŸ (27.21ç§’)
- âœ… æ‰“åŒ…å¤§å°: 1.1M

### æ­¥éª¤2: ä¸Šä¼ åˆ°ç”Ÿäº§æœåŠ¡å™¨
```bash
scp deploy-package.tar.gz saas@172.16.2.221:/tmp/
```
- âœ… ä¸Šä¼ æˆåŠŸ

### æ­¥éª¤3: æœåŠ¡å™¨éƒ¨ç½²
```bash
cd /home/saas/proxy-system
tar -xzf /tmp/deploy-package.tar.gz
```
- âœ… æ–‡ä»¶è§£å‹å®Œæˆ
- âš ï¸ éƒ¨åˆ†æ–‡ä»¶æƒé™é—®é¢˜å·²æ‰‹åŠ¨ä¿®å¤

### æ­¥éª¤4: æ•°æ®åº“è¿ç§»
```bash
python3 src/scripts/create_finance_settings_tables.py
python3 src/scripts/init_finance_settings_data.py
```
- âœ… åˆ›å»ºæ”¶ä»˜æ¬¾æ¸ é“è¡¨
- âœ… åˆ›å»ºæ”¶å…¥ç±»åˆ«è¡¨
- âœ… åˆ›å»ºæŠ¥é”€ç±»åˆ«è¡¨
- âœ… åˆ›å»ºæ”¯å‡ºç±»åˆ«è¡¨
- âœ… åˆå§‹åŒ– 59 æ¡æ”¯å‡ºç±»åˆ«æ•°æ®
- âœ… åˆå§‹åŒ– 4 æ¡æ”¶ä»˜æ¬¾æ¸ é“æ•°æ®

### æ­¥éª¤5: é‡å¯æœåŠ¡
```bash
pkill -f "uvicorn.*main:app"
nohup uvicorn src.main:app --host 0.0.0.0 --port 8000 --workers 4 &
```
- âœ… åç«¯æœåŠ¡å·²é‡å¯
- âœ… å¥åº·æ£€æŸ¥é€šè¿‡

---

## âœ… éªŒè¯ç»“æœ

### åç«¯æœåŠ¡
- **çŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œ
- **ç«¯å£**: 8000
- **å¥åº·æ£€æŸ¥**: http://172.16.2.221:8000/health
- **APIæ–‡æ¡£**: http://172.16.2.221:8000/docs

### å‰ç«¯æœåŠ¡
- **çŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œ (é€šè¿‡Nginxä»£ç†)
- **ç«¯å£**: 80 (Nginxä»£ç†)
- **è®¿é—®åœ°å€**: http://172.16.2.221

### æ•°æ®åº“
- **è´¢åŠ¡è®¾ç½®è¡¨**: âœ… å·²åˆ›å»º
  - shoufukuan_qudao (æ”¶ä»˜æ¬¾æ¸ é“)
  - shouru_leibie (æ”¶å…¥ç±»åˆ«)
  - baoxiao_leibie (æŠ¥é”€ç±»åˆ«)
  - zhichu_leibie (æ”¯å‡ºç±»åˆ«)
- **åˆå§‹æ•°æ®**: âœ… å·²å¯¼å…¥
  - 4æ¡æ”¶ä»˜æ¬¾æ¸ é“
  - 59æ¡æ”¯å‡ºç±»åˆ«

---

## ğŸ“Š åŠŸèƒ½éªŒè¯

### 1. è´¢åŠ¡è®¾ç½®æ¨¡å—
- âœ… è®¿é—®è·¯å¾„: http://172.16.2.221/settings/finance
- âœ… æ”¶ä»˜æ¬¾æ¸ é“ç®¡ç†
- âœ… æ”¶å…¥ç±»åˆ«ç®¡ç†
- âœ… æŠ¥é”€ç±»åˆ«ç®¡ç†
- âœ… æ”¯å‡ºç±»åˆ«ç®¡ç†ï¼ˆæ ‘çŠ¶å›¾å±•ç¤ºï¼‰
- âœ… è‡ªåŠ¨ç¼–ç ç”ŸæˆåŠŸèƒ½

### 2. é‡‡è´­ç”³è¯·æ¨¡å—
- âœ… åˆ›å»ºé¡µé¢: http://172.16.2.221/office/procurement/create
- âœ… é‡‡è´­ç±»å‹åŠ¨æ€åŠ è½½ï¼ˆä»æ”¯å‡ºç±»åˆ«APIï¼‰
- âœ… åªæ˜¾ç¤ºå¯ç”¨çŠ¶æ€çš„ç±»åˆ«
- âœ… åˆ—è¡¨ç­›é€‰åŠŸèƒ½æ­£å¸¸

### 3. æŠ¥é”€ç”³è¯·æ¨¡å—
- âœ… åˆ›å»ºé¡µé¢: http://172.16.2.221/office/reimbursement/create
- âœ… æŠ¥é”€ç±»å‹åŠ¨æ€åŠ è½½ï¼ˆä»æŠ¥é”€ç±»åˆ«APIï¼‰
- âœ… åªæ˜¾ç¤ºå¯ç”¨çŠ¶æ€çš„ç±»åˆ«
- âœ… åˆ—è¡¨ç­›é€‰åŠŸèƒ½æ­£å¸¸

---

## ğŸ”§ æŠ€æœ¯æ”¹è¿›

### 1. æ•°æ®è”åŠ¨
- è´¢åŠ¡è®¾ç½®ä¸ä¸šåŠ¡æ¨¡å—å®ç°æ•°æ®è”åŠ¨
- è´¢åŠ¡äººå‘˜ä¿®æ”¹ç±»åˆ«åï¼Œä¸šåŠ¡é¡µé¢è‡ªåŠ¨æ›´æ–°

### 2. ç¼–ç è‡ªåŠ¨ç”Ÿæˆ
- æ ¼å¼: å‰ç¼€ + æ—¥æœŸ(YYYYMMDD) + åºå·(3ä½)
- ç¤ºä¾‹: SR20251112001, BX20251112001, ZC20251112001
- é¿å…æ‰‹åŠ¨è¾“å…¥é”™è¯¯ï¼Œä¿è¯å”¯ä¸€æ€§

### 3. ç³»ç»Ÿå¯ç»´æŠ¤æ€§
- ç§»é™¤æ‰€æœ‰ç¡¬ç¼–ç çš„ç±»å‹é€‰é¡¹
- æå‡æ•°æ®ä¸€è‡´æ€§
- ç®€åŒ–åç»­ç»´æŠ¤å·¥ä½œ

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ•°æ®å…¼å®¹æ€§
- æ—§æ•°æ®å¯èƒ½å­˜å‚¨ç¡¬ç¼–ç å€¼ï¼ˆå¦‚"bangongyongpin"ï¼‰
- æ–°æ•°æ®å­˜å‚¨ç±»åˆ«åç§°ï¼ˆå¦‚"åŠå…¬ç”¨å“"ï¼‰
- getTypeLabelå‡½æ•°å·²ç®€åŒ–ï¼Œå…¼å®¹ä¸¤ç§æƒ…å†µ

### 2. æƒé™é…ç½®
- è´¢åŠ¡è®¾ç½®çš„GETè¯·æ±‚å·²ç§»é™¤è®¤è¯è¦æ±‚
- æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥æŸ¥çœ‹ç±»åˆ«åˆ—è¡¨
- åªæœ‰æœ‰æƒé™çš„ç”¨æˆ·æ‰èƒ½ä¿®æ”¹è´¢åŠ¡è®¾ç½®

### 3. æ€§èƒ½ä¼˜åŒ–
- æ”¯å‡ºç±»åˆ«è·å–200æ¡æ•°æ®
- æŠ¥é”€ç±»åˆ«è·å–100æ¡æ•°æ®
- å¯æ ¹æ®å®é™…æ•°æ®é‡è°ƒæ•´

---

## ğŸ“ åç»­å·¥ä½œ

### å»ºè®®äº‹é¡¹
1. âœ… æµ‹è¯•å®Œæ•´çš„ä¸šåŠ¡æµç¨‹
2. âœ… éªŒè¯æ•°æ®è”åŠ¨åŠŸèƒ½
3. â³ é…ç½®è´¢åŠ¡è®¾ç½®æƒé™
4. â³ ç›‘æ§ç³»ç»Ÿæ€§èƒ½
5. â³ æ”¶é›†ç”¨æˆ·åé¦ˆ

### å¯é€‰ä¼˜åŒ–
1. ä¸ºæ”¶å…¥ç±»åˆ«æ·»åŠ åˆå§‹æ•°æ®
2. ä¸ºæŠ¥é”€ç±»åˆ«æ·»åŠ æ›´å¤šåˆå§‹æ•°æ®
3. å®ç°ç¼–ç è§„åˆ™çš„å¯é…ç½®åŒ–
4. æ·»åŠ ç±»åˆ«ä½¿ç”¨ç»Ÿè®¡åŠŸèƒ½

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- åç«¯æ—¥å¿—: `ssh saas@172.16.2.221 'tail -f /home/saas/proxy-system/logs/backend.log'`
- å‰ç«¯æ—¥å¿—: `ssh saas@172.16.2.221 'tail -f /home/saas/proxy-system/logs/frontend.log'`

---

**éƒ¨ç½²çŠ¶æ€**: âœ… æˆåŠŸ  
**éƒ¨ç½²è€—æ—¶**: çº¦5åˆ†é’Ÿ  
**å½±å“èŒƒå›´**: è´¢åŠ¡è®¾ç½®ã€é‡‡è´­ç”³è¯·ã€æŠ¥é”€ç”³è¯·æ¨¡å—  
**å›æ»šæ–¹æ¡ˆ**: ä½¿ç”¨å¤‡ä»½ backup-20251112-111931

