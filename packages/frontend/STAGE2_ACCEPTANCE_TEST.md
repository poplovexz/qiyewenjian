# 阶段2：合同生成与电子签署 - 前端验收测试计划

## 测试环境
- **后端服务**: http://localhost:8000 ✅ 已启动
- **前端服务**: http://localhost:5174 ✅ 已启动
- **测试浏览器**: Chrome/Firefox/Safari
- **测试账号**: 需要有合同管理权限的账号

## 验收测试清单

### 1. 合同乙方主体管理功能 ✅

#### 1.1 乙方主体列表页面
- [ ] 访问 `/contract-parties` 页面能正常加载
- [ ] 页面显示乙方主体列表表格
- [ ] 表格包含以下列：主体名称、主体类型、联系人、联系电话、证件号码、状态、操作
- [ ] 搜索功能：可按主体名称、联系人搜索
- [ ] 分页功能：支持分页显示，每页条数可选择
- [ ] 新增按钮：点击"新增乙方主体"按钮跳转到创建页面

#### 1.2 乙方主体创建页面
- [ ] 访问 `/contract-parties/create` 页面能正常加载
- [ ] 表单包含所有必填字段：主体名称、主体类型、联系人、联系电话、联系邮箱
- [ ] 表单包含可选字段：证件类型、证件号码、注册地址、开户行、银行账户、备注
- [ ] 主体类型下拉选择：个人、公司、其他
- [ ] 证件类型下拉选择：身份证、营业执照、其他
- [ ] 表单验证：必填字段为空时显示错误提示
- [ ] 邮箱格式验证：邮箱格式不正确时显示错误提示
- [ ] 电话格式验证：电话号码格式验证
- [ ] 保存按钮：点击保存成功后跳转到列表页面并显示成功提示
- [ ] 取消按钮：点击取消返回列表页面

#### 1.3 乙方主体编辑页面
- [ ] 从列表页面点击"编辑"按钮能跳转到编辑页面
- [ ] 编辑页面预填充现有数据
- [ ] 可以修改所有字段
- [ ] 保存修改后显示成功提示并返回列表页面
- [ ] 取消编辑返回列表页面

#### 1.4 乙方主体删除功能
- [ ] 列表页面每行有删除按钮
- [ ] 点击删除按钮显示确认对话框
- [ ] 确认删除后从列表中移除该记录
- [ ] 取消删除不执行任何操作

### 2. 合同支付方式管理功能 ✅

#### 2.1 支付方式列表页面
- [ ] 访问 `/payment-methods` 页面能正常加载
- [ ] 页面显示支付方式列表表格
- [ ] 表格包含以下列：乙方主体、支付方式、账户名称、账户号码、开户行、是否默认、状态、操作
- [ ] 搜索功能：可按乙方主体、账户名称搜索
- [ ] 筛选功能：可按支付方式类型筛选
- [ ] 分页功能：支持分页显示
- [ ] 新增按钮：点击"新增支付方式"按钮跳转到创建页面

#### 2.2 支付方式创建页面
- [ ] 访问 `/payment-methods/create` 页面能正常加载
- [ ] 乙方主体选择：下拉选择已有的乙方主体
- [ ] 支付方式类型选择：银行转账、微信支付、支付宝、其他
- [ ] 必填字段验证：账户名称、账户号码
- [ ] 银行转账时开户行字段必填
- [ ] 是否默认选择：单选框
- [ ] 保存成功后跳转到列表页面

#### 2.3 支付方式编辑和删除
- [ ] 编辑功能：可以修改支付方式信息
- [ ] 删除功能：删除前显示确认对话框
- [ ] 默认支付方式切换：可以设置/取消默认支付方式

### 3. 合同生成与预览功能 ✅

#### 3.1 基于报价生成合同
- [ ] 在报价确认成功后显示"是否生成合同"的确认对话框
- [ ] 选择"生成合同"跳转到合同创建页面 `/contracts/create?baojia_id=xxx`
- [ ] 合同创建页面自动预填报价相关信息：合同名称、合同金额、关联报价ID
- [ ] 可以选择乙方主体（从已创建的乙方主体中选择）
- [ ] 可以选择合同模板（从已有模板中选择）

#### 3.2 合同创建页面
- [ ] 访问 `/contracts/create` 页面能正常加载
- [ ] 表单包含必填字段：合同名称、合同类型、合同金额
- [ ] 表单包含可选字段：乙方主体、关联报价、合同内容、签订日期、生效日期、结束日期、备注
- [ ] 合同类型下拉选择：代理记账、税务咨询、其他
- [ ] 日期选择器：签订日期、生效日期、结束日期
- [ ] 富文本编辑器：合同内容编辑
- [ ] 保存草稿：保存为草稿状态
- [ ] 提交审核：提交后状态变为待签署

#### 3.3 合同预览功能
- [ ] 访问 `/contracts/preview` 页面能正常加载
- [ ] 可以选择合同模板进行预览
- [ ] 可以输入变量值进行模板渲染
- [ ] 预览区域实时显示渲染后的合同内容
- [ ] 支持打印预览功能

#### 3.4 合同列表页面
- [ ] 访问 `/contracts` 页面能正常加载
- [ ] 显示合同列表表格
- [ ] 表格包含：合同编号、合同名称、乙方主体、合同金额、状态、创建时间、操作
- [ ] 状态筛选：可按合同状态筛选（草稿、待签署、已签署、已完成、已取消）
- [ ] 搜索功能：可按合同名称、乙方主体搜索
- [ ] 操作按钮：查看、编辑、签署、删除

### 4. 电子签名功能 ✅

#### 4.1 合同签署页面
- [ ] 从合同列表点击"签署"按钮跳转到签署页面
- [ ] 页面显示完整的合同内容
- [ ] 签名区域：提供手写签名画布
- [ ] 手写签名功能：
  - [ ] 可以用鼠标/触摸屏进行手写签名
  - [ ] 提供清除按钮清空签名
  - [ ] 提供撤销按钮撤销上一步操作
  - [ ] 签名画布大小适中，支持响应式
- [ ] 文本签名功能：
  - [ ] 提供文本输入框输入签名文字
  - [ ] 可以选择签名字体样式
  - [ ] 文本签名预览
- [ ] 签名方式切换：可以在手写签名和文本签名之间切换
- [ ] 确认签署按钮：完成签名后点击确认
- [ ] 取消签署按钮：取消签署返回合同列表

#### 4.2 签署后状态更新
- [ ] 签署成功后合同状态更新为"已签署"
- [ ] 显示签署成功提示信息
- [ ] 记录签署人和签署时间
- [ ] 签署后的合同不能再次编辑
- [ ] 可以查看签署后的合同（包含签名信息）

### 5. 导航和用户体验 ✅

#### 5.1 导航菜单
- [ ] 左侧导航菜单包含"合同管理"主菜单
- [ ] 合同管理子菜单包含：合同列表、乙方主体、支付方式、合同模板
- [ ] 菜单项点击能正确跳转到对应页面
- [ ] 当前页面菜单项高亮显示

#### 5.2 面包屑导航
- [ ] 每个页面都有正确的面包屑导航
- [ ] 面包屑可以点击跳转到上级页面

#### 5.3 响应式设计
- [ ] 页面在不同屏幕尺寸下正常显示
- [ ] 移动端适配良好
- [ ] 表格在小屏幕下可以横向滚动

#### 5.4 错误处理
- [ ] 网络错误时显示友好的错误提示
- [ ] 表单验证错误时显示具体的错误信息
- [ ] 操作失败时显示错误原因

#### 5.5 加载状态
- [ ] 数据加载时显示加载动画
- [ ] 按钮点击后显示加载状态
- [ ] 长时间操作显示进度提示

## 验收标准

### 功能完整性
- [ ] 所有列出的功能都能正常工作
- [ ] 没有功能缺失或异常

### 用户体验
- [ ] 界面美观，符合设计规范
- [ ] 操作流程顺畅，符合用户习惯
- [ ] 错误提示清晰，帮助用户解决问题

### 性能要求
- [ ] 页面加载时间 < 3秒
- [ ] 操作响应时间 < 1秒
- [ ] 大数据量列表加载正常

### 兼容性
- [ ] 支持主流浏览器（Chrome、Firefox、Safari、Edge）
- [ ] 移动端浏览器兼容性良好

## 测试结果记录

### 测试执行人：_______
### 测试日期：_______
### 测试环境：_______

### 发现的问题：
1. 
2. 
3. 

### 验收结论：
- [ ] 通过验收，可以进入下一阶段
- [ ] 需要修复问题后重新验收

### 备注：
