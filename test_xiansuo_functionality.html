<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çº¿ç´¢ç®¡ç†åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1, h2 {
            color: #333;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        .iframe-container {
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: none;
            display: none;
        }
        pre {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” çº¿ç´¢ç®¡ç†åŠŸèƒ½æµ‹è¯•</h1>
        <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•çº¿ç´¢ç®¡ç†åŠŸèƒ½çš„å‰åç«¯é›†æˆæƒ…å†µ</p>
        
        <div class="test-section">
            <h2>ğŸ“¡ åç«¯æœåŠ¡æµ‹è¯•</h2>
            <button onclick="testBackendServices()">æµ‹è¯•åç«¯API</button>
            <div id="backendResult"></div>
        </div>

        <div class="test-section">
            <h2>ğŸŒ å‰ç«¯é¡µé¢æµ‹è¯•</h2>
            <button onclick="testFrontendPages()">æµ‹è¯•å‰ç«¯é¡µé¢</button>
            <div id="frontendResult"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ”— çº¿ç´¢ç®¡ç†é¡µé¢è®¿é—®</h2>
            <button onclick="openXiansuoPage()">æ‰“å¼€çº¿ç´¢ç®¡ç†é¡µé¢</button>
            <button onclick="openApiDocs()">æ‰“å¼€APIæ–‡æ¡£</button>
            <div id="pageResult"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ“Š åŠŸèƒ½éªŒæ”¶æ¸…å•</h2>
            <div id="checklistResult">
                <h3>âœ… å·²å®Œæˆçš„åŠŸèƒ½ï¼š</h3>
                <ul>
                    <li>âœ… çº¿ç´¢ç®¡ç†æ•°æ®åº“è¡¨è®¾è®¡å’Œåˆ›å»º</li>
                    <li>âœ… çº¿ç´¢æ¥æºç®¡ç†ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰</li>
                    <li>âœ… çº¿ç´¢çŠ¶æ€ç®¡ç†ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰</li>
                    <li>âœ… çº¿ç´¢ä¸»è¡¨ç®¡ç†ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰</li>
                    <li>âœ… çº¿ç´¢è·Ÿè¿›è®°å½•ç®¡ç†ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰</li>
                    <li>âœ… åç«¯APIæ¥å£å¼€å‘</li>
                    <li>âœ… å‰ç«¯é¡µé¢å’Œç»„ä»¶å¼€å‘</li>
                    <li>âœ… è·¯ç”±é…ç½®å’Œèœå•é›†æˆ</li>
                    <li>âœ… æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬</li>
                </ul>
                
                <h3>ğŸ”„ éœ€è¦éªŒè¯çš„åŠŸèƒ½ï¼š</h3>
                <ul>
                    <li>ğŸ”„ ç”¨æˆ·ç™»å½•å’Œæƒé™éªŒè¯</li>
                    <li>ğŸ”„ çº¿ç´¢åˆ—è¡¨é¡µé¢æ˜¾ç¤º</li>
                    <li>ğŸ”„ çº¿ç´¢åˆ›å»ºå’Œç¼–è¾‘åŠŸèƒ½</li>
                    <li>ğŸ”„ çº¿ç´¢è¯¦æƒ…æŸ¥çœ‹åŠŸèƒ½</li>
                    <li>ğŸ”„ çº¿ç´¢è·Ÿè¿›è®°å½•åŠŸèƒ½</li>
                    <li>ğŸ”„ çº¿ç´¢çŠ¶æ€æ›´æ–°åŠŸèƒ½</li>
                    <li>ğŸ”„ çº¿ç´¢åˆ†é…åŠŸèƒ½</li>
                    <li>ğŸ”„ çº¿ç´¢ç»Ÿè®¡æ•°æ®æ˜¾ç¤º</li>
                </ul>
            </div>
        </div>

        <div class="iframe-container">
            <iframe id="testFrame"></iframe>
        </div>
    </div>

    <script>
        const BACKEND_BASE = 'http://localhost:8000';
        const FRONTEND_BASE = 'http://localhost:5174';

        function log(containerId, message, type = 'info') {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = message;
            container.appendChild(div);
        }

        function clearResults(containerId) {
            document.getElementById(containerId).innerHTML = '';
        }

        async function testBackendServices() {
            clearResults('backendResult');
            log('backendResult', 'ğŸš€ å¼€å§‹æµ‹è¯•åç«¯æœåŠ¡...', 'info');

            const endpoints = [
                { name: 'APIæ ¹è·¯å¾„', url: `${BACKEND_BASE}/` },
                { name: 'APIæ–‡æ¡£', url: `${BACKEND_BASE}/docs` },
                { name: 'å¥åº·æ£€æŸ¥', url: `${BACKEND_BASE}/health` },
                { name: 'çº¿ç´¢æ¥æºAPI', url: `${BACKEND_BASE}/api/v1/lead-sources/` },
                { name: 'çº¿ç´¢çŠ¶æ€API', url: `${BACKEND_BASE}/api/v1/lead-statuses/` },
                { name: 'çº¿ç´¢ç®¡ç†API', url: `${BACKEND_BASE}/api/v1/leads/` },
                { name: 'çº¿ç´¢è·Ÿè¿›API', url: `${BACKEND_BASE}/api/v1/lead-followups/` }
            ];

            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(endpoint.url, { method: 'HEAD' });
                    if (response.ok || response.status === 401) {
                        log('backendResult', `âœ… ${endpoint.name}: å¯è®¿é—® (${response.status})`, 'success');
                    } else {
                        log('backendResult', `âŒ ${endpoint.name}: è®¿é—®å¤±è´¥ (${response.status})`, 'error');
                    }
                } catch (error) {
                    log('backendResult', `âŒ ${endpoint.name}: è¿æ¥å¤±è´¥ (${error.message})`, 'error');
                }
            }

            log('backendResult', 'âœ… åç«¯æœåŠ¡æµ‹è¯•å®Œæˆï¼', 'success');
        }

        async function testFrontendPages() {
            clearResults('frontendResult');
            log('frontendResult', 'ğŸš€ å¼€å§‹æµ‹è¯•å‰ç«¯é¡µé¢...', 'info');

            const pages = [
                { name: 'é¦–é¡µ', url: `${FRONTEND_BASE}/` },
                { name: 'ç™»å½•é¡µ', url: `${FRONTEND_BASE}/login` },
                { name: 'çº¿ç´¢ç®¡ç†', url: `${FRONTEND_BASE}/leads` },
                { name: 'å®¢æˆ·ç®¡ç†', url: `${FRONTEND_BASE}/customers` }
            ];

            for (const page of pages) {
                try {
                    const response = await fetch(page.url, { method: 'HEAD' });
                    if (response.ok) {
                        log('frontendResult', `âœ… ${page.name}: å¯è®¿é—® (${response.status})`, 'success');
                    } else {
                        log('frontendResult', `âŒ ${page.name}: è®¿é—®å¤±è´¥ (${response.status})`, 'error');
                    }
                } catch (error) {
                    log('frontendResult', `âŒ ${page.name}: è¿æ¥å¤±è´¥ (${error.message})`, 'error');
                }
            }

            log('frontendResult', 'âœ… å‰ç«¯é¡µé¢æµ‹è¯•å®Œæˆï¼', 'success');
        }

        function openXiansuoPage() {
            clearResults('pageResult');
            log('pageResult', 'ğŸ”— æ­£åœ¨æ‰“å¼€çº¿ç´¢ç®¡ç†é¡µé¢...', 'info');
            
            const iframe = document.getElementById('testFrame');
            iframe.src = `${FRONTEND_BASE}/leads`;
            iframe.style.display = 'block';
            
            log('pageResult', 'âœ… çº¿ç´¢ç®¡ç†é¡µé¢å·²åœ¨ä¸‹æ–¹iframeä¸­æ˜¾ç¤º', 'success');
            log('pageResult', 'ğŸ“ è¯·æ‰‹åŠ¨æµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š', 'warning');
            log('pageResult', 'â€¢ ç™»å½•ç³»ç»Ÿï¼ˆç”¨æˆ·åï¼šadminï¼Œå¯†ç ï¼šadmin123ï¼‰', 'info');
            log('pageResult', 'â€¢ æŸ¥çœ‹çº¿ç´¢åˆ—è¡¨', 'info');
            log('pageResult', 'â€¢ åˆ›å»ºæ–°çº¿ç´¢', 'info');
            log('pageResult', 'â€¢ ç¼–è¾‘çº¿ç´¢ä¿¡æ¯', 'info');
            log('pageResult', 'â€¢ æŸ¥çœ‹çº¿ç´¢è¯¦æƒ…', 'info');
            log('pageResult', 'â€¢ æ·»åŠ è·Ÿè¿›è®°å½•', 'info');
        }

        function openApiDocs() {
            clearResults('pageResult');
            log('pageResult', 'ğŸ“š æ­£åœ¨æ‰“å¼€APIæ–‡æ¡£...', 'info');
            
            const iframe = document.getElementById('testFrame');
            iframe.src = `${BACKEND_BASE}/docs`;
            iframe.style.display = 'block';
            
            log('pageResult', 'âœ… APIæ–‡æ¡£å·²åœ¨ä¸‹æ–¹iframeä¸­æ˜¾ç¤º', 'success');
            log('pageResult', 'ğŸ“ å¯ä»¥åœ¨APIæ–‡æ¡£ä¸­æµ‹è¯•ä»¥ä¸‹æ¥å£ï¼š', 'warning');
            log('pageResult', 'â€¢ /api/v1/leads/ - çº¿ç´¢ç®¡ç†', 'info');
            log('pageResult', 'â€¢ /api/v1/lead-sources/ - çº¿ç´¢æ¥æºç®¡ç†', 'info');
            log('pageResult', 'â€¢ /api/v1/lead-statuses/ - çº¿ç´¢çŠ¶æ€ç®¡ç†', 'info');
            log('pageResult', 'â€¢ /api/v1/lead-followups/ - çº¿ç´¢è·Ÿè¿›ç®¡ç†', 'info');
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡ŒåŸºç¡€æµ‹è¯•
        window.onload = function() {
            log('backendResult', 'ğŸ¯ é¡µé¢å·²åŠ è½½ï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•', 'info');
            log('frontendResult', 'ğŸ¯ ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•å‰ç«¯é¡µé¢', 'info');
            log('pageResult', 'ğŸ¯ ç‚¹å‡»æŒ‰é’®æ‰“å¼€çº¿ç´¢ç®¡ç†é¡µé¢è¿›è¡Œæ‰‹åŠ¨æµ‹è¯•', 'info');
        };
    </script>
</body>
</html>
